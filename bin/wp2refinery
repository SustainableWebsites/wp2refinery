#!/usr/bin/env ruby
require 'hpricot'
require 'trollop'

opts = Trollop::options do
  opt :file, "File to import", :required => true, :type => String
  opt :database, "MySQL database", :type => String
  opt :username, "MySQL database user", :type => String
  opt :password, "MySQL database password", :type => String
end

# Parse XML
xml = Hpricot.XML(File.read(opts[:file]))

xml.search("//item").each do |item|
  # Post
  if item.search('wp:post_type').inner_html == "post"
    #p item.search("title").inner_html
    
    item.search('wp:comment').each do |comment|
      unless comment.search('wp:comment_approved').inner_html == "spam"
        p comment.search('wp:comment_content').inner_html
      end
    end
    
    
  elsif item.search('wp:post_type').inner_html == "attachment"
    # Attachments
  end
  
  
  
end

# Insert into Refinery blog db

